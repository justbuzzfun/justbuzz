<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TITAN MONITOR</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background-color: #000; color: #fff; font-family: 'Roboto Mono', monospace; padding: 20px; text-align: center; }
        
        .header { border-bottom: 2px solid #00ff41; padding-bottom: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 22px; color: #00ff41; font-weight: bold; text-shadow: 0 0 10px #00ff41; }
        
        /* Ù…Ø§Ù†ÛŒØªÙˆØ± ÙˆØ¶Ø¹ÛŒØª */
        .monitor-box {
            background: #111; border: 1px dashed #333; padding: 20px; border-radius: 10px; margin-bottom: 20px;
        }
        .monitor-status { color: #888; font-size: 12px; margin-top: 10px; }
        .active-dot { height: 10px; width: 10px; background-color: #333; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .active-dot.on { background-color: #00ff41; box-shadow: 0 0 10px #00ff41; }

        /* Ø¯Ú©Ù…Ù‡ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ */
        .activate-btn {
            background: #00bcd4; color: #000; border: none; padding: 15px 30px; font-weight: bold; font-size: 16px; border-radius: 50px; cursor: pointer; width: 100%; max-width: 300px; margin-bottom: 20px; animation: pulse 2s infinite;
        }

        #feed { display: flex; flex-direction: column; gap: 12px; text-align: left; }
        
        .card { background: #0a0a0a; border: 1px solid #333; padding: 15px; border-radius: 8px; animation: slideIn 0.3s ease-out; border-left: 5px solid #00ff41; box-shadow: 0 0 20px rgba(0, 255, 65, 0.1); }
        
        .row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 13px; }
        .token-addr { color: #00bcd4; font-family: monospace; letter-spacing: 1px; }
        .badge { padding: 3px 6px; border-radius: 3px; font-size: 10px; color: #000; font-weight: bold; background: #00ff41; }
        
        .buy-btn { width: 100%; background: #00ff41; color: #000; border: none; padding: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; text-transform: uppercase; border-radius: 4px; font-size: 16px; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes slideIn { from { transform: translateY(-10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo">âš¡ TITAN</div>
        <div class="active-dot" id="dot"></div>
    </div>

    <!-- Ø¯Ú©Ù…Ù‡ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø¨ÛŒØ¯Ø§Ø±ÛŒ -->
    <button class="activate-btn" onclick="activateMonitoring()">ğŸ”” ACTIVATE MONITORING</button>

    <div class="monitor-box">
        <div>STATUS: <span id="status" style="color:#00ff41">CONNECTING...</span></div>
        <div class="monitor-status" id="wakeStatus">Screen Sleep: ENABLED (Click Button to Disable)</div>
    </div>

    <div id="feed"></div>

    <audio id="alertSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const feed = document.getElementById('feed');
        const alertSound = document.getElementById('alertSound');
        let wakeLock = null;

        // --- 1. ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø­Ø§Ù„Øª Ù†Ú¯Ù‡Ø¨Ø§Ù†ÛŒ (Ø¨ÛŒØ¯Ø§Ø±ÛŒ + ØµØ¯Ø§) ---
        async function activateMonitoring() {
            // Ø§Ù„Ù) Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
            if (Notification.permission !== "granted") {
                Notification.requestPermission();
            }

            // Ø¨) Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ø®Ø§Ù„ÛŒ (Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù‚ÙÙ„ ØµØ¯Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±)
            alertSound.play().then(() => {
                alertSound.pause();
                alertSound.currentTime = 0;
            }).catch(()=>{});

            // Ø¬) Ø±ÙˆØ´Ù† Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† ØµÙØ­Ù‡ (Wake Lock)
            try {
                wakeLock = await navigator.wakeLock.request('screen');
                document.getElementById('wakeStatus').innerText = "ğŸš« SCREEN SLEEP: BLOCKED (Keeping Awake)";
                document.getElementById('wakeStatus').style.color = "gold";
                document.querySelector('.activate-btn').style.display = 'none'; // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡
                alert("Monitoring Active! Do not close this tab.");
            } catch (err) {
                document.getElementById('wakeStatus').innerText = "âš ï¸ Wake Lock Failed. Keep screen on manually.";
            }
        }

        socket.on('status', (data) => {
            document.getElementById('status').innerText = data.msg;
            document.getElementById('dot').classList.add('on');
        });

        socket.on('god-signal', (data) => {
            // ÙÙ‚Ø· Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù† (Ø³Ø¨Ø²) Ù…ÛŒØ§Ø¯ Ú†ÙˆÙ† Ø³Ø±ÙˆØ± ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù‡
            
            // 1. Ù¾Ø®Ø´ ØµØ¯Ø§
            alertSound.currentTime = 0;
            alertSound.play().catch(()=>{});

            // 2. Ù„Ø±Ø²Ø´ Ú¯ÙˆØ´ÛŒ
            if (navigator.vibrate) navigator.vibrate([500, 200, 500]);

            // 3. Ø§Ø±Ø³Ø§Ù„ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ø³ÛŒØ³ØªÙ…ÛŒ (Ø¨Ø§Ù„Ø§ÛŒ Ú¯ÙˆØ´ÛŒ)
            if (Notification.permission === "granted") {
                new Notification("ğŸ’ GEM FOUND!", {
                    body: "Safe Token Detected. Click to Ape.",
                    icon: "https://cryptologos.cc/logos/solana-sol-logo.png"
                });
            }

            // 4. Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ø±Øª
            const card = document.createElement('div');
            card.className = 'card safe';
            const photonLink = `https://photon-sol.tinyastro.io/en/lp/${data.address}`;

            card.innerHTML = `
                <div class="row">
                    <span class="token-addr">${data.address.substring(0,6)}...</span>
                    <span class="badge">SCORE: 100</span>
                </div>
                <div class="row" style="color:#ccc; font-size:11px;">
                    Mint: ${data.mintAuth} | LP: Locked
                </div>
                <button class="buy-btn" onclick="window.open('${photonLink}', '_blank')">ğŸš€ BUY NOW</button>
            `;
            
            feed.prepend(card);
        });

        // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ù‚ÙÙ„ Ø¨ÛŒØ¯Ø§Ø±ÛŒ Ø§Ú¯Ø± ØµÙØ­Ù‡ Ù…Ø®ÙÛŒ Ùˆ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨Ø§Ø² Ø´Ø¯
        document.addEventListener('visibilitychange', async () => {
            if (wakeLock !== null && document.visibilityState === 'visible') {
                wakeLock = await navigator.wakeLock.request('screen');
            }
        });
    </script>
</body>
</html>
