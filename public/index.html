<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TREND HUNTER V3 (FILTERED)</title>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background-color: #000; color: #fff; font-family: 'Chakra Petch', sans-serif; margin: 0; padding: 20px; }
        
        /* HEADER */
        .header { border-bottom: 2px solid #333; padding-bottom: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; background: #000; z-index: 100; }
        .logo { font-size: 22px; font-weight: bold; color: gold; letter-spacing: 2px; }
        .status { font-size: 11px; color: #666; }

        /* GRID */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }

        /* CARD */
        .card { background: #080808; border: 1px solid #222; padding: 15px; border-radius: 6px; position: relative; transition: 0.3s; opacity: 0.5; filter: grayscale(1); }
        
        /* ACTIVE CARDS (SIGNAL) */
        .card.active { opacity: 1; filter: grayscale(0); border: 2px solid #fff; order: -1; transform: scale(1.02); }
        .card.long { border-color: #00ff41; box-shadow: 0 0 20px rgba(0, 255, 65, 0.2); }
        .card.short { border-color: #ff0055; box-shadow: 0 0 20px rgba(255, 0, 85, 0.2); }

        .card-header { display: flex; justify-content: space-between; font-size: 18px; font-weight: bold; margin-bottom: 10px; }
        .trend-badge { font-size: 10px; padding: 2px 5px; border-radius: 3px; background: #333; }
        
        .data-row { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px; color: #888; }
        .val { color: #fff; font-weight: bold; }
        
        .signal-box { margin-top: 10px; text-align: center; font-weight: bold; padding: 8px; border-radius: 4px; font-size: 14px; background: #111; color: #555; }
        
        .card.long .signal-box { background: #00ff41; color: #000; animation: pulse 1s infinite; }
        .card.short .signal-box { background: #ff0055; color: #fff; animation: pulse 1s infinite; }

        .positive { color: #00ff41; }
        .negative { color: #ff0055; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.8; } 100% { opacity: 1; } }
        #loading { text-align: center; margin-top: 50px; color: gold; }
    </style>
</head>
<body>

    <div class="header">
        <div>
            <div class="logo">ğŸ¯ TREND SNIPER</div>
            <div class="status">AUTO-FILTER: ONLY TRADE WITH TREND</div>
        </div>
        <button onclick="toggleSound()" style="background:#222; color:#fff; border:1px solid gold; padding:5px 10px; cursor:pointer;">ğŸ”Š ON</button>
    </div>

    <div id="loading">INITIALIZING TREND FILTERS...</div>
    <div id="grid" class="grid"></div>

    <audio id="alertSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script>
        const grid = document.getElementById('grid');
        const loading = document.getElementById('loading');
        let soundEnabled = true;
        let pairs = [];

        // 1. Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø§Ø±Ø²Ù‡Ø§
        async function init() {
            try {
                const res = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
                const data = await res.json();
                
                // Ø§Ù†ØªØ®Ø§Ø¨ Û±Û°Û° Ø§Ø±Ø² Ù¾Ø±Ø­Ø¬Ù…
                pairs = data
                    .filter(p => p.symbol.endsWith('USDT') && parseFloat(p.quoteVolume) > 10000000)
                    .sort((a, b) => parseFloat(b.quoteVolume) - parseFloat(a.quoteVolume))
                    .slice(0, 100);

                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÛŒ Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø®Ø§Øµ
                const specialCoins = ['PNUTUSDT', 'ACTUSDT', 'FILUSDT', '1000PEPEUSDT'];
                specialCoins.forEach(coin => {
                    if (!pairs.find(p => p.symbol === coin)) pairs.push({ symbol: coin });
                });

                loading.style.display = 'none';
                startScanning();
            } catch (e) {
                loading.innerText = "VPN REQUIRED FOR BINANCE DATA";
            }
        }

        // 2. Ø§Ø³Ú©Ù† Ù…Ø¯Ø§ÙˆÙ…
        async function startScanning() {
            for (let i = 0; i < pairs.length; i++) {
                await analyzePair(pairs[i].symbol);
                await new Promise(r => setTimeout(r, 100)); // ØªØ§Ø®ÛŒØ± Ú©Ù…
            }
            setTimeout(startScanning, 3000);
        }

        // 3. ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´Ù…Ù†Ø¯ (ÙÛŒÙ„ØªØ±Ø¯Ø§Ø±)
        async function analyzePair(symbol) {
            try {
                // Ø¯Ø±ÛŒØ§ÙØª Ø¯ÛŒØªØ§ÛŒ Û²Û´ Ø³Ø§Ø¹Øª (Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ø±ÙˆÙ†Ø¯) Ùˆ Ø¯ÛŒØªØ§ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ
                const [tickerRes, klineRes, fundingRes] = await Promise.all([
                    fetch(`https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=${symbol}`),
                    fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${symbol}&interval=5m&limit=50`), // Ú©Ù†Ø¯Ù„ Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø³ÛŒÚ¯Ù†Ø§Ù„
                    fetch(`https://fapi.binance.com/fapi/v1/premiumIndex?symbol=${symbol}`)
                ]);

                const ticker = await tickerRes.json();
                const kline = await klineRes.json();
                const funding = await fundingRes.json();

                // Ù…Ø­Ø§Ø³Ø¨Ø§Øª
                const change24h = parseFloat(ticker.priceChangePercent);
                const currentPrice = parseFloat(ticker.lastPrice);
                const fundingRate = parseFloat(funding.lastFundingRate) * 100;
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ RSI Ø¯Ø³ØªÛŒ Ø±ÙˆÛŒ Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡
                const closes = kline.map(k => parseFloat(k[4]));
                const rsi = calculateRSI(closes, 14);

                // --- ğŸ§  Ù…ØºØ² Ù…ØªÙÚ©Ø± (ÙÛŒÙ„ØªØ± Ø±ÙˆÙ†Ø¯) ---
                let signal = "WAIT";
                let cardClass = "";
                
                // Ø´Ø±Ø· Û±: ØªØ¹ÛŒÛŒÙ† Ø¬Ù‡Øª Ù…Ø¬Ø§Ø²
                const trend = change24h > 0 ? 'UP' : 'DOWN';

                // Ø´Ø±Ø· Û²: Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¯Ù‡ÛŒ ÙÙ‚Ø· Ø¯Ø± Ø¬Ù‡Øª Ø±ÙˆÙ†Ø¯
                if (trend === 'UP') {
                    // ÙÙ‚Ø· Ø¯Ù†Ø¨Ø§Ù„ Ø®Ø±ÛŒØ¯ Ø¨Ø§Ø´
                    // Ø§Ú¯Ø± Ù‚ÛŒÙ…Øª Ø§ØµÙ„Ø§Ø­ Ú©Ø±Ø¯Ù‡ (RSI Ù¾Ø§ÛŒÛŒÙ†) Ùˆ ÙØ§Ù†Ø¯ÛŒÙ†Ú¯ Ø§ÙˆÚ©ÛŒÙ‡
                    if (rsi < 35 && fundingRate < 0.03) {
                        signal = "ğŸŸ¢ BUY DIP";
                        cardClass = "active long";
                        if(rsi < 30) playSound(); // ÙÙ‚Ø· Ø§Ú¯Ù‡ Ø®ÛŒÙ„ÛŒ Ø®ÙˆØ¨ Ø¨ÙˆØ¯ Ø¨ÙˆÙ‚ Ø¨Ø²Ù†
                    }
                } 
                else if (trend === 'DOWN') {
                    // ÙÙ‚Ø· Ø¯Ù†Ø¨Ø§Ù„ ÙØ±ÙˆØ´ Ø¨Ø§Ø´
                    // Ø§Ú¯Ø± Ù‚ÛŒÙ…Øª Ø±ÙØªÙ‡ Ø¨Ø§Ù„Ø§ (RSI Ø¨Ø§Ù„Ø§)
                    if (rsi > 65) {
                        signal = "ğŸ”´ SELL RALLY";
                        cardClass = "active short";
                        if(rsi > 70) playSound();
                    }
                }

                updateCard(symbol, currentPrice, change24h, rsi, fundingRate, signal, cardClass, trend);

            } catch (e) {}
        }

        // 4. Ù†Ù…Ø§ÛŒØ´
        function updateCard(symbol, price, change, rsi, funding, signal, cardClass, trend) {
            let card = document.getElementById(symbol);
            if (!card) {
                card = document.createElement('div');
                card.id = symbol;
                grid.appendChild(card);
            }

            const changeColor = change >= 0 ? 'positive' : 'negative';
            
            // Ø§Ú¯Ù‡ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ù†ÛŒØ³ØªØŒ Ú©Ø§Ø±Øª Ø±Ùˆ Ú©Ù…Ø±Ù†Ú¯ Ú©Ù†
            card.className = `card ${cardClass}`;
            
            card.innerHTML = `
                <div class="card-header">
                    <span>${symbol.replace('USDT','')}</span>
                    <span class="${changeColor}">${change.toFixed(2)}%</span>
                </div>
                
                <div class="data-row">
                    <span>TREND (Daily):</span> 
                    <span class="trend-badge" style="color:${trend==='UP'?'#0f0':'#f00'}">${trend}</span>
                </div>
                <div class="data-row">
                    <span>RSI (5m):</span> <span class="val" style="color:${rsi>70?'red':(rsi<30?'lime':'#888')}">${rsi.toFixed(1)}</span>
                </div>
                <div class="data-row">
                    <span>Funding:</span> <span class="val">${funding.toFixed(4)}%</span>
                </div>

                <div class="signal-box">${signal}</div>
            `;
            
            // Ø³ÙˆØ±Øª Ú©Ø±Ø¯Ù†: Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ú©ØªÛŒÙˆ Ø¨Ø±Ù† Ø¨Ø§Ù„Ø§
            card.style.order = cardClass.includes('active') ? "-1" : "0";
        }

        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
        function calculateRSI(prices, period) {
            let gains = 0, losses = 0;
            for (let i = prices.length - period; i < prices.length; i++) {
                const diff = prices[i] - prices[i - 1];
                if (diff >= 0) gains += diff;
                else losses -= diff;
            }
            const rs = gains / losses;
            return 100 - (100 / (1 + rs));
        }

        function playSound() { if(soundEnabled) document.getElementById('alertSound').play().catch(()=>{}); }
        function toggleSound() { soundEnabled = !soundEnabled; alert("Sound: " + soundEnabled); }

        init();
    </script>
</body>
</html>
